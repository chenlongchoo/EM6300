<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>mTouch CVD Framework: Tuning the CVD Waveform - Troubleshooting the Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="main.html">main</a>      </li>
      <li><a class="el" href="_troubleshoot.html">Troubleshooting the Framework</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Tuning the CVD Waveform - Troubleshooting the Framework </h1>  </div>
</div>
<div class="contents">
<p>Below is a picture of what the CVD waveform should look like on a scope. Note that sensor lines are used both for scanning themselves and the other sensors. You may notice the sensor being pulled high and low during other sensor's scans.</p>
<div align="center">
<img src="cvdWaveform.jpg" alt="cvdWaveform.jpg"/>
</div>
<p>The mTouch framework provides the ability to tune the timing of CVD waveform for specific hardware designs. The amount of parasitic capacitance, the size of the sensor, the size of the sensor's series resistor, and VDD all play a role in determining the amount of time required to charge/discharge during each step of the scan.</p>
<div align="center">
<img src="cvdWaveformDelay.jpg" alt="cvdWaveformDelay.jpg"/>
<p><strong>CVD Waveform Delay Configuration Options</strong></p></div>
<p> <br/>
</p>
<ul>
<li><b>CVD_CHOLD_CHARGE_DELAY</b><br/>
<br/>
 This value determines the amount of time provided for charging the internal hold capacitor of the ADC. <br/>
<br/>
 If this value is <b>too small</b>: There will be noticable crosstalk between closely-indexed sensors that is not related to the hardware layout of the application.<br/>
 If this value is <b>too large</b>: The mTouch ISR will take an unnecessarily long amount of time to execute.<br/>
<br/>
 <b>To correctly set this value:</b> <ol>
<li>
Set this value to 0, compile and program. </li>
<li>
Look at the raw values on the mTouch GUI or through a terminal program. </li>
<li>
Produce the largest shift possible on the sensor with the highest amount of capacitance by pressing on it. ("Highest Capacitance" usually corresponds to the sensor with the highest unpressed raw value.) <ul>
<li>
Do you notice a strange crosstalk behavior on a different sensor? If no, leave this value to 0. If yes... </li>
</ul>
</li>
<li>
Increase the delay until the crosstalk behavior is eliminated. </li>
</ol>
<br/>
 Once you've solved the crosstalk for the sensor with the highest amount of capacitance, the others will be fine as well and you have correctly tuned the Chold delay time.</li>
</ul>
<p><br/>
</p>
<ul>
<li><b>CVD_SETTLING_DELAY</b><br/>
<br/>
 This value determines the amount of time provided for the external sensor and internal hold capacitor to charge-average their voltages.<br/>
<br/>
 If this value is <b>too small</b>: The sensors will not be as sensitive as they could be and your sensor's readings will be VDD dependant.<br/>
 If this value is <b>too large</b>: The noise immunity of the system will not be as robust as it could be.<br/>
<br/>
 <b>To correctly set this value:</b> <ol>
<li>
Set this value to 0, compile and program. </li>
<li>
Look at the raw values on the mTouch GUI or through a terminal program while powering the system at the desired VDD level. </li>
<li>
Adjust VDD by plus and minus 0.5V <ul>
<li>
Do you notice any change in the unpressed value as VDD is changing? If no, leave this value alone. If yes... </li>
</ul>
</li>
<li>
Increase the delay until the sensor's reading no longer changes as VDD changes. </li>
</ol>
<br/>
 Once this has occurred, the settling time has been correctly tuned to provide the maximum amount of sensitivity while minimizing the framework's susceptibility to noise. </li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>mTouch CVD Framework v1.1 documentation by&#160;
<a href="http://www.microchip.com"> 
<img class="footer" src="../includes/mchp.jpeg" alt="Click here to visit our website at www.microchip.com"/></a></small></address> 
</body> 
</html> 
