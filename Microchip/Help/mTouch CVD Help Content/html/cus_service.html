<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>mTouch CVD Framework: Implementing a Custom Service() Function</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="main.html">main</a>      </li>
      <li><a class="el" href="_getting_started.html">Getting Started</a>      </li>
      <li><a class="el" href="custom.html">Customizing Framework Behavior</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Implementing a Custom Service() Function </h1>  </div>
</div>
<div class="contents">
<p>Some users may wish to create their own service function to interpret the sensor's readings. The easiest way to handle this is to copy the <a class="el" href="m_touch_c_v_d_8c.html" title="This module provides a group of functions performing the post acquisition filtering and decoding for ...">mTouchCVD.c</a> file from the library to your local project directory. Change the <a class="el" href="m_touch_c_v_d_8c.html" title="This module provides a group of functions performing the post acquisition filtering and decoding for ...">mTouchCVD.c</a> file location in your project and make all edits to the local version.</p>
<h2><a class="anchor" id="cusService1"></a>
* Replacing the Default mTouch Service Call</h2>
<p>The mTouchCVD_Decode() function is called once each sensor has been scanned. New reading values for each sensor can be accessed with the <a class="el" href="m_touch_c_v_d_8h.html#a266898ac8fe1cc86038bbd1ec8c4ca8d" title="Abstraction macro for array access.">CVDGetSensor(i)</a> macro, where i is the Sensor# as defined in the configuration file.</p>
<h2><a class="anchor" id="cusService2"></a>
* Replacing the default mTouch Initialization Function</h2>
<p>The majority of the default mTouch initialization function is dedicated to preparing the decode and filtering module. Since you are creating your own service function, this initialization function should be replaced with one that initializes your own variables.<br/>
 To initalize the mTouch framework, make sure to include the following code blocks. function: </p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i = 0; i &lt; <a class="code" href="group___configuration.html#ga392407b03210dcc0d87246c8f6911a5b" title="Number of CVD Sensor Inputs.">CVD_NUMBER_SENSORS</a>; i++)
 {
   <a class="code" href="group___acquisition.html#ga789fbd8b393b2914790565dfc98ef130" title="GLOBAL: Internal mTouch acquisition variable - do not modify.">sensor_data</a>[i] = 0x47F; <span class="comment">// Initializes the acquisition module&#39;s sensor_data array to minimize initalization time</span>
 }
</pre></div> <div class="fragment"><pre class="fragment"> CVD_SET_ADC_CLK();        <span class="comment">// Automatically configures the ADC&#39;s clock based on your configuration file&#39;s _XTAL_FREQ value</span>
                           <span class="comment">// Alternatively, you can initialize the ADC registers yourself</span>
</pre></div> <div class="fragment"><pre class="fragment"><span class="preprocessor"> #if defined(CVD_DEBUG) &amp;&amp; (CVD_DEBUG == 1)</span>
<span class="preprocessor"></span> mTouchCVD_Comm_Init();    <span class="comment">// OPTIONAL - Call this if you want to use the default mTouch comm implementation</span>
<span class="preprocessor"> #endif</span>
</pre></div> <div class="fragment"><pre class="fragment"> CVD_SET_TMR0IE();         <span class="comment">// REQUIRED</span>
 CVD_SET_GIE();            <span class="comment">// REQUIRED</span>
</pre></div> </div>
<hr class="footer"/><address class="footer"><small>mTouch CVD Framework v1.1 documentation by&#160;
<a href="http://www.microchip.com"> 
<img class="footer" src="../includes/mchp.jpeg" alt="Click here to visit our website at www.microchip.com"/></a></small></address> 
</body> 
</html> 
